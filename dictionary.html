<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Indian Slang Dictionary - Live Search 850+ Terms | SlangAdda AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Live searchable dictionary of Indian slang terms with meanings, examples, context, and safety ratings. Free forever." />
  
  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  
  <!-- CSS Files -->
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Live Search Styles */
    .live-search-container {
      position: relative;
      max-width: 800px;
      margin: 0 auto 30px;
    }
    
    .search-results-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border-radius: 0 0 var(--radius) var(--radius);
      box-shadow: var(--shadow-lg);
      max-height: 300px;
      overflow-y: auto;
      display: none;
      z-index: 1000;
      border: 2px solid var(--primary);
      border-top: none;
    }
    
    .search-result-item {
      padding: 15px 20px;
      border-bottom: 1px solid var(--gray-light);
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .search-result-item:hover {
      background: #f8fafc;
    }
    
    .search-result-term {
      font-weight: 600;
      color: var(--primary);
      font-size: 1.1rem;
    }
    
    .search-result-meaning {
      color: var(--gray);
      font-size: 0.9rem;
      max-width: 60%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .search-result-item:last-child {
      border-bottom: none;
    }
    
    /* Term Detail Modal */
    .term-detail-modal {
      max-width: 700px;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .term-header {
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      padding: 30px;
      border-radius: var(--radius) var(--radius) 0 0;
    }
    
    .term-title {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 10px;
    }
    
    .term-pronunciation {
      font-size: 1.1rem;
      opacity: 0.9;
      margin-bottom: 15px;
    }
    
    .term-meaning {
      font-size: 1.3rem;
      font-weight: 500;
    }
    
    .term-content {
      padding: 30px;
    }
    
    .term-section {
      margin-bottom: 25px;
      padding-bottom: 25px;
      border-bottom: 2px solid var(--gray-light);
    }
    
    .term-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }
    
    .term-section h4 {
      color: var(--primary);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .safety-badge {
      display: inline-block;
      padding: 5px 12px;
      border-radius: 50px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-left: 10px;
    }
    
    .safety-office {
      background: rgba(16, 185, 129, 0.1);
      color: #10b981;
    }
    
    .safety-casual {
      background: rgba(245, 158, 11, 0.1);
      color: #f59e0b;
    }
    
    .safety-avoid {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
    }
    
    .example-box {
      background: #f8fafc;
      padding: 20px;
      border-radius: var(--radius);
      border-left: 4px solid var(--primary);
      font-style: italic;
      margin: 15px 0;
    }
    
    .term-stats {
      display: flex;
      gap: 20px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 2px solid var(--gray-light);
    }
    
    .term-stat {
      text-align: center;
      flex: 1;
    }
    
    .term-stat-number {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
      display: block;
    }
    
    .term-stat-label {
      font-size: 0.8rem;
      color: var(--gray);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    /* Loading Animation */
    .search-loading {
      text-align: center;
      padding: 20px;
      color: var(--gray);
    }
    
    .loading-dots {
      display: inline-flex;
      gap: 5px;
    }
    
    .loading-dots span {
      width: 8px;
      height: 8px;
      background: var(--primary);
      border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out both;
    }
    
    .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
    .loading-dots span:nth-child(2) { animation-delay: -0.16s; }
    
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }
    
    /* Dictionary Grid */
    .dictionary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
      margin: 30px 0;
    }
    
    .dictionary-card {
      background: white;
      border-radius: var(--radius);
      padding: 25px;
      box-shadow: var(--shadow);
      border: 1px solid var(--gray-light);
      transition: var(--transition);
      cursor: pointer;
    }
    
    .dictionary-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
      border-color: var(--primary);
    }
    
    .card-term {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 10px;
    }
    
    .card-meaning {
      color: var(--gray);
      line-height: 1.5;
      margin-bottom: 15px;
      height: 60px;
      overflow: hidden;
    }
    
    .card-category {
      display: inline-block;
      background: rgba(99, 102, 241, 0.1);
      color: var(--primary);
      padding: 5px 12px;
      border-radius: 50px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 15px;
    }
    
    .card-example {
      font-size: 0.9rem;
      color: var(--dark);
      font-style: italic;
      padding: 10px;
      background: #f8fafc;
      border-radius: var(--radius-sm);
      margin-bottom: 15px;
    }
    
    .card-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
      color: var(--gray);
    }
    
    .card-views {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    /* No Results */
    .no-results {
      text-align: center;
      padding: 60px 20px;
      background: white;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    
    .no-results i {
      font-size: 3rem;
      color: var(--gray-light);
      margin-bottom: 20px;
    }
    
    .no-results h3 {
      color: var(--gray);
      margin-bottom: 10px;
    }
  </style>
</head>

<body>

<!-- NAVBAR -->
<header class="navbar">
  <div class="logo">SlangAdda<span>AI</span></div>
  <nav>
    <a href="index.html"><i class="fas fa-home"></i> Home</a>
    <a href="dictionary.html" class="active"><i class="fas fa-book"></i> Dictionary</a>
    <a href="quiz.html"><i class="fas fa-brain"></i> Quiz</a>
    <a href="blog.html"><i class="fas fa-blog"></i> Blog</a>
    <a href="index.html#support" class="support-nav"><i class="fas fa-heart"></i> Support</a>
  </nav>
</header>

<!-- ADVERTISEMENT TOP -->
<div class="container">
  <div class="ad-container">
    <div class="ad-label">Advertisement</div>
    <div class="ad-unit horizontal ad-trackable" data-ad-id="dict-top">
      <i class="fas fa-ad"></i>
      <p>728×90 Ad Space</p>
      <small>Your ad here. Contact: ads@slangadda.ai</small>
    </div>
  </div>
</div>

<!-- DICTIONARY HEADER -->
<section class="dictionary-header">
  <div class="container">
    <h1><i class="fas fa-book-open"></i> Indian Slang Dictionary</h1>
    <p class="subtitle">Live search through our growing collection of Indian slang terms. Real-time updates, verified meanings.</p>
    
    <div class="dictionary-stats">
      <div class="stat">
        <span class="number" id="totalTermsLive">850+</span>
        <span class="label">Slang Terms</span>
      </div>
      <div class="stat">
        <span class="number" id="updatedToday">24</span>
        <span class="label">New Today</span>
      </div>
      <div class="stat">
        <span class="number" id="mostSearched">5,280</span>
        <span class="label">Monthly Searches</span>
      </div>
      <div class="stat">
        <span class="number">100% Free</span>
        <span class="label">Always Free</span>
      </div>
    </div>
    
    <div class="live-search-container">
      <div class="search-box-large">
        <input type="text" id="dictionarySearch" placeholder="Type any slang term... (try 'rizz', 'delulu', 'chapri')" autocomplete="off">
        <button id="searchButton">
          <i class="fas fa-search"></i> Search Dictionary
        </button>
      </div>
      <div class="search-results-dropdown" id="searchResultsDropdown"></div>
      <div class="search-tips">
        <p><i class="fas fa-lightbulb"></i> <strong>Live Search:</strong> Start typing for instant results</p>
        <div class="quick-suggestions">
          <span class="quick-suggestion" data-term="rizz">rizz</span>
          <span class="quick-suggestion" data-term="delulu">delulu</span>
          <span class="quick-suggestion" data-term="chapri">chapri</span>
          <span class="quick-suggestion" data-term="ghoomna">ghoomna</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ADVERTISEMENT MIDDLE -->
<div class="container">
  <div class="ad-container dictionary-ad">
    <div class="ad-label">Sponsored</div>
    <div class="ad-unit ad-trackable" data-ad-id="dict-middle">
      <i class="fas fa-ad"></i>
      <p>300×250 Medium Rectangle</p>
      <small>Premium ad placement. Contact: ads@slangadda.ai</small>
    </div>
  </div>
</div>

<!-- FEATURED TERMS -->
<div class="container">
  <div class="featured-terms">
    <h2><i class="fas fa-star"></i> Featured Terms This Week</h2>
    <p class="section-subtitle">Trending slang terms you should know</p>
    
    <div class="terms-carousel" id="featuredCarousel">
      <!-- Loaded dynamically -->
    </div>
  </div>
</div>

<!-- DICTIONARY CONTENT -->
<section class="dictionary-content">
  <div class="container">
    <div class="dictionary-controls">
      <div class="controls-left">
        <div class="filter-buttons">
          <button class="filter-btn active" data-filter="all">
            <i class="fas fa-layer-group"></i> All Terms
          </button>
          <button class="filter-btn" data-filter="genz">
            <i class="fas fa-users"></i> Gen-Z
          </button>
          <button class="filter-btn" data-filter="professional">
            <i class="fas fa-briefcase"></i> Professional
          </button>
          <button class="filter-btn" data-filter="regional">
            <i class="fas fa-map-marker-alt"></i> Regional
          </button>
          <button class="filter-btn" data-filter="internet">
            <i class="fas fa-globe"></i> Internet
          </button>
        </div>
      </div>
      
      <div class="controls-right">
        <div class="sort-options">
          <label for="sortSelect"><i class="fas fa-sort-amount-down"></i> Sort by:</label>
          <select id="sortSelect">
            <option value="popularity">Most Popular</option>
            <option value="alphabetical">A to Z</option>
            <option value="newest">Newest First</option>
            <option value="trending">Trending</option>
          </select>
        </div>
      </div>
    </div>
    
    <div class="dictionary-grid" id="dictionaryGrid">
      <!-- Dictionary items loaded via JavaScript -->
    </div>
    
    <div class="load-more-container">
      <button id="loadMoreBtn" class="load-more-btn">
        <i class="fas fa-sync-alt"></i> Load More Terms
      </button>
      <p class="load-more-note">
        Showing <span id="showingCount">20</span> of <span id="totalCount">850+</span> terms
      </p>
    </div>
    
    <!-- RELATED TERMS -->
    <div class="related-terms" id="relatedTermsSection" style="display: none;">
      <h3><i class="fas fa-random"></i> Related Terms</h3>
      <div class="related-grid" id="relatedTermsGrid">
        <!-- Related terms loaded by JavaScript -->
      </div>
    </div>
  </div>
</section>

<!-- ADVERTISEMENT BOTTOM -->
<div class="container">
  <div class="ad-container">
    <div class="ad-label">Advertisement</div>
    <div class="ad-unit horizontal ad-trackable" data-ad-id="dict-bottom">
      <i class="fas fa-ad"></i>
      <p>728×90 Footer Ad</p>
      <small>Your ad here. Contact: ads@slangadda.ai</small>
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer>
  <div class="footer-content">
    <div class="footer-section">
      <h3>SlangAdda<span>AI</span></h3>
      <p class="footer-tagline">Free Indian slang decoder. No ads. No tracking. Just understanding.</p>
      <div class="footer-links">
        <a href="index.html"><i class="fas fa-home"></i> Home</a>
        <a href="dictionary.html" class="active"><i class="fas fa-book"></i> Dictionary</a>
        <a href="quiz.html"><i class="fas fa-brain"></i> Quiz</a>
        <a href="blog.html"><i class="fas fa-blog"></i> Blog</a>
        <a href="admin.html"><i class="fas fa-lock"></i> Admin</a>
      </div>
    </div>
    
    <div class="footer-section">
      <h4><i class="fas fa-info-circle"></i> Dictionary Info</h4>
      <a href="index.html#submit-slang"><i class="fas fa-plus"></i> Suggest New Term</a>
      <a href="#" id="reportErrorLink"><i class="fas fa-flag"></i> Report Error</a>
      <a href="#" id="viewHistoryLink"><i class="fas fa-history"></i> Update History</a>
      <a href="mailto:contribute@slangadda.ai"><i class="fas fa-code"></i> Contribute</a>
      <a href="mailto:ads@slangadda.ai"><i class="fas fa-ad"></i> Advertise</a>
    </div>
    
    <div class="footer-section">
      <h4><i class="fas fa-share-alt"></i> Connect</h4>
      <div class="social-links">
        <a href="#"><i class="fab fa-twitter"></i> Twitter</a>
        <a href="#"><i class="fab fa-instagram"></i> Instagram</a>
        <a href="#"><i class="fab fa-github"></i> GitHub</a>
        <a href="mailto:hello@slangadda.ai"><i class="fas fa-envelope"></i> Email</a>
        <a href="mailto:ads@slangadda.ai"><i class="fas fa-ad"></i> Ad Sales</a>
      </div>
    </div>
    
    <div class="footer-section">
      <h4><i class="fas fa-chart-line"></i> Live Stats</h4>
      <p><i class="fas fa-book"></i> <span id="footerTermCount">850+</span> Terms</p>
      <p><i class="fas fa-users"></i> <span id="footerUserCount">50K+</span> Monthly Users</p>
      <p><i class="fas fa-search"></i> <span id="footerSearchCount">2M+</span> Searches</p>
      <p><i class="fas fa-heart"></i> Community-Driven</p>
      <p><i class="fas fa-ad"></i> Ad-Supported</p>
    </div>
  </div>
  
  <div class="footer-bottom">
    <p>© 2025 SlangAdda AI · Made with ❤️ for India · Keeping knowledge free for everyone</p>
    <p class="footer-note">
      Dictionary updated in real-time. Help us grow by suggesting new terms!
    </p>
  </div>
</footer>

<!-- Term Details Modal -->
<div class="modal" id="termModal">
  <div class="modal-content term-detail-modal">
    <span class="close-modal">&times;</span>
    <div class="modal-body" id="termModalBody">
      <!-- Term details loaded here -->
    </div>
  </div>
</div>

<!-- JavaScript -->
<script src="firebase-config.js"></script>
<script src="script.js"></script>

<script>
  // Dictionary Page JavaScript
  document.addEventListener('DOMContentLoaded', function() {
    // Initialize dictionary
    initializeDictionary();
    
    // Setup live search
    setupLiveSearch();
    
    // Setup filters
    setupFilters();
    
    // Setup quick suggestions
    setupQuickSuggestions();
    
    // Load terms
    loadTerms();
    
    // Load featured terms
    loadFeaturedTerms();
    
    // Initialize ad tracking
    setupAdTracking();
    
    // Check URL for search parameter
    const urlParams = new URLSearchParams(window.location.search);
    const searchTerm = urlParams.get('search');
    if (searchTerm) {
      document.getElementById('dictionarySearch').value = searchTerm;
      performSearch(searchTerm);
    }
    
    // Update live stats
    updateLiveStats();
  });
  
  let currentFilter = 'all';
  let currentSort = 'popularity';
  let lastVisible = null;
  let isLoading = false;
  let allTerms = [];
  let filteredTerms = [];
  
  function initializeDictionary() {
    // Initialize Firestore if not already
    if (!window.firestoreDB) {
      console.error('Firebase not initialized');
      // Load from local database as fallback
      loadLocalTerms();
      return;
    }
  }
  
  function setupLiveSearch() {
    const searchInput = document.getElementById('dictionarySearch');
    const searchResults = document.getElementById('searchResultsDropdown');
    const searchButton = document.getElementById('searchButton');
    
    if (!searchInput) return;
    
    // Search on input with debounce
    let searchTimeout;
    searchInput.addEventListener('input', function() {
      clearTimeout(searchTimeout);
      const query = this.value.trim();
      
      if (query.length === 0) {
        searchResults.style.display = 'none';
        return;
      }
      
      searchTimeout = setTimeout(() => {
        performLiveSearch(query);
      }, 300);
    });
    
    // Search on button click
    if (searchButton) {
      searchButton.addEventListener('click', function() {
        const query = searchInput.value.trim();
        if (query) {
          performSearch(query);
        }
      });
    }
    
    // Search on Enter key
    searchInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        const query = searchInput.value.trim();
        if (query) {
          performSearch(query);
        }
      }
    });
    
    // Hide results when clicking outside
    document.addEventListener('click', function(e) {
      if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
        searchResults.style.display = 'none';
      }
    });
  }
  
  function performLiveSearch(query) {
    const searchResults = document.getElementById('searchResultsDropdown');
    const searchInput = document.getElementById('dictionarySearch');
    
    if (!query || query.length < 2) {
      searchResults.style.display = 'none';
      return;
    }
    
    // Show loading
    searchResults.innerHTML = `
      <div class="search-loading">
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <p>Searching...</p>
      </div>
    `;
    searchResults.style.display = 'block';
    
    // Perform search in Firestore
    firestoreDB.collection('slang_terms')
      .where('term', '>=', query.toLowerCase())
      .where('term', '<=', query.toLowerCase() + '\uf8ff')
      .limit(10)
      .get()
      .then(snapshot => {
        if (snapshot.empty) {
          // Try searching in meanings too
          return firestoreDB.collection('slang_terms')
            .where('meaning', '>=', query)
            .where('meaning', '<=', query + '\uf8ff')
            .limit(10)
            .get();
        }
        return snapshot;
      })
      .then(snapshot => {
        searchResults.innerHTML = '';
        
        if (snapshot.empty) {
          searchResults.innerHTML = `
            <div class="search-result-item">
              <div style="text-align: center; width: 100%; color: var(--gray); padding: 20px;">
                <i class="fas fa-search" style="font-size: 1.5rem; margin-bottom: 10px; display: block;"></i>
                <p>No results found for "${query}"</p>
                <button onclick="window.location.href='index.html#submit-slang'" style="margin-top: 10px; padding: 8px 16px; background: var(--primary); color: white; border: none; border-radius: var(--radius); cursor: pointer;">
                  Suggest this term
                </button>
              </div>
            </div>
          `;
          return;
        }
        
        snapshot.forEach(doc => {
          const data = doc.data();
          const resultItem = document.createElement('div');
          resultItem.className = 'search-result-item';
          resultItem.innerHTML = `
            <div class="search-result-term">${data.term}</div>
            <div class="search-result-meaning">${data.meaning.substring(0, 50)}...</div>
          `;
          resultItem.addEventListener('click', function() {
            showTermDetails(data.term);
            searchInput.value = data.term;
            searchResults.style.display = 'none';
          });
          searchResults.appendChild(resultItem);
        });
        
        // Add a "View all results" option
        const viewAll = document.createElement('div');
        viewAll.className = 'search-result-item';
        viewAll.style.background = '#f8fafc';
        viewAll.innerHTML = `
          <div style="text-align: center; width: 100%; color: var(--primary); font-weight: 600;">
            <i class="fas fa-arrow-right"></i> View all results for "${query}"
          </div>
        `;
        viewAll.addEventListener('click', function() {
          performSearch(query);
          searchResults.style.display = 'none';
        });
        searchResults.appendChild(viewAll);
      })
      .catch(error => {
        console.error('Search error:', error);
        searchResults.innerHTML = `
          <div class="search-result-item" style="color: var(--danger);">
            <i class="fas fa-exclamation-circle"></i> Error loading results
          </div>
        `;
      });
  }
  
  function performSearch(query) {
    if (!query) return;
    
    // Update URL without reload
    const url = new URL(window.location);
    url.searchParams.set('search', query);
    window.history.pushState({}, '', url);
    
    // Filter terms locally for immediate response
    const searchLower = query.toLowerCase();
    const results = allTerms.filter(term => 
      term.term.toLowerCase().includes(searchLower) ||
      term.meaning.toLowerCase().includes(searchLower) ||
      (term.examples && term.examples.toLowerCase().includes(searchLower))
    );
    
    displaySearchResults(results, query);
    
    // Also log the search in Firestore
    logSearch(query, results.length);
  }
  
  function displaySearchResults(results, query) {
    const grid = document.getElementById('dictionaryGrid');
    const relatedSection = document.getElementById('relatedTermsSection');
    const showingCount = document.getElementById('showingCount');
    const totalCount = document.getElementById('totalCount');
    
    if (results.length === 0) {
      grid.innerHTML = `
        <div class="no-results" style="grid-column: 1 / -1;">
          <i class="fas fa-search"></i>
          <h3>No results found for "${query}"</h3>
          <p>Try a different search term or suggest this term to our community!</p>
          <button onclick="window.location.href='index.html#submit-slang'" class="hero-btn primary" style="margin-top: 20px;">
            <i class="fas fa-plus"></i> Suggest this term
          </button>
        </div>
      `;
      relatedSection.style.display = 'none';
      showingCount.textContent = '0';
      return;
    }
    
    grid.innerHTML = '';
    results.forEach(term => {
      grid.appendChild(createTermCard(term));
    });
    
    showingCount.textContent = results.length;
    totalCount.textContent = results.length;
    
    // Hide related terms during search
    relatedSection.style.display = 'none';
    
    // Show search header
    const searchHeader = document.createElement('div');
    searchHeader.style.gridColumn = '1 / -1';
    searchHeader.style.textAlign = 'center';
    searchHeader.style.marginBottom = '20px';
    searchHeader.style.padding = '20px';
    searchHeader.style.background = 'white';
    searchHeader.style.borderRadius = 'var(--radius)';
    searchHeader.style.boxShadow = 'var(--shadow)';
    searchHeader.innerHTML = `
      <h3 style="color: var(--primary); margin-bottom: 10px;">
        <i class="fas fa-search"></i> Search Results for "${query}"
      </h3>
      <p>Found ${results.length} matching term${results.length !== 1 ? 's' : ''}</p>
      <button onclick="clearSearch()" class="hero-btn secondary" style="margin-top: 15px; padding: 10px 20px;">
        <i class="fas fa-times"></i> Clear Search
      </button>
    `;
    grid.insertBefore(searchHeader, grid.firstChild);
  }
  
  function clearSearch() {
    document.getElementById('dictionarySearch').value = '';
    document.getElementById('searchResultsDropdown').style.display = 'none';
    
    // Remove search from URL
    const url = new URL(window.location);
    url.searchParams.delete('search');
    window.history.pushState({}, '', url);
    
    // Reload all terms
    loadTerms();
  }
  
  function loadTerms() {
    const grid = document.getElementById('dictionaryGrid');
    const loadMoreBtn = document.getElementById('loadMoreBtn');
    
    // Show loading
    grid.innerHTML = `
      <div class="no-results" style="grid-column: 1 / -1;">
        <div class="loading-dots" style="justify-content: center; margin-bottom: 20px;">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <p>Loading slang terms...</p>
      </div>
    `;
    
    // Load from Firestore
    let query = firestoreDB.collection('slang_terms');
    
    // Apply filter
    if (currentFilter !== 'all') {
      query = query.where('category', '==', currentFilter);
    }
    
    // Apply sort
    switch(currentSort) {
      case 'alphabetical':
        query = query.orderBy('term', 'asc');
        break;
      case 'newest':
        query = query.orderBy('createdAt', 'desc');
        break;
      case 'trending':
        query = query.orderBy('views', 'desc');
        break;
      case 'popularity':
      default:
        query = query.orderBy('popularity', 'desc');
        break;
    }
    
    query.limit(20).get()
      .then(snapshot => {
        grid.innerHTML = '';
        allTerms = [];
        
        if (snapshot.empty) {
          grid.innerHTML = `
            <div class="no-results" style="grid-column: 1 / -1;">
              <i class="fas fa-book"></i>
              <h3>No terms found</h3>
              <p>Be the first to add slang terms to our dictionary!</p>
            </div>
          `;
          loadMoreBtn.style.display = 'none';
          return;
        }
        
        const last = snapshot.docs[snapshot.docs.length - 1];
        lastVisible = last;
        
        snapshot.forEach(doc => {
          const data = doc.data();
          data.id = doc.id;
          allTerms.push(data);
          grid.appendChild(createTermCard(data));
        });
        
        // Update counts
        document.getElementById('showingCount').textContent = snapshot.size;
        document.getElementById('totalCount').textContent = '850+';
        
        // Show related terms
        showRelatedTerms();
        
        // Setup load more
        loadMoreBtn.style.display = 'block';
        loadMoreBtn.onclick = loadMoreTerms;
      })
      .catch(error => {
        console.error('Error loading terms:', error);
        // Fallback to local data
        loadLocalTerms();
      });
  }
  
  function createTermCard(term) {
    const card = document.createElement('div');
    card.className = 'dictionary-card';
    card.onclick = () => showTermDetails(term.term);
    
    let safetyBadge = '';
    if (term.safety === 'office-safe') {
      safetyBadge = '<span class="safety-badge safety-office">Office Safe</span>';
    } else if (term.safety === 'casual') {
      safetyBadge = '<span class="safety-badge safety-casual">Casual</span>';
    } else if (term.safety === 'avoid') {
      safetyBadge = '<span class="safety-badge safety-avoid">Avoid</span>';
    }
    
    card.innerHTML = `
      <div class="card-term">${term.term} ${safetyBadge}</div>
      <div class="card-category">${term.category || 'General'}</div>
      <div class="card-meaning">${term.meaning.substring(0, 100)}${term.meaning.length > 100 ? '...' : ''}</div>
      ${term.examples ? `<div class="card-example">"${term.examples.substring(0, 80)}${term.examples.length > 80 ? '...' : ''}"</div>` : ''}
      <div class="card-footer">
        <div class="card-views">
          <i class="fas fa-eye"></i> ${term.views || 0}
        </div>
        <div>
          <i class="fas fa-star" style="color: #f59e0b;"></i> ${term.rating || '⭐⭐⭐⭐⭐'}
        </div>
      </div>
    `;
    
    return card;
  }
  
  function showTermDetails(termName) {
    const modal = document.getElementById('termModal');
    const modalBody = document.getElementById('termModalBody');
    
    // Show loading
    modalBody.innerHTML = `
      <div class="term-header">
        <div class="loading-dots" style="justify-content: center; color: white;">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <p style="text-align: center; color: white; margin-top: 20px;">Loading term details...</p>
      </div>
    `;
    
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
    
    // Get term from Firestore
    firestoreDB.collection('slang_terms')
      .where('term', '==', termName.toLowerCase())
      .limit(1)
      .get()
      .then(snapshot => {
        if (snapshot.empty) {
          modalBody.innerHTML = `
            <div class="term-header" style="background: var(--danger);">
              <h2 class="term-title">Term Not Found</h2>
              <p>The term "${termName}" was not found in our dictionary.</p>
            </div>
            <div class="term-content">
              <div class="term-section">
                <h4><i class="fas fa-exclamation-triangle"></i> Term Not Found</h4>
                <p>This term might not be in our database yet.</p>
                <button onclick="window.location.href='index.html#submit-slang'" class="hero-btn primary" style="margin-top: 20px;">
                  <i class="fas fa-plus"></i> Submit this term
                </button>
              </div>
            </div>
          `;
          return;
        }
        
        const doc = snapshot.docs[0];
        const data = doc.data();
        
        // Update view count
        firestoreDB.collection('slang_terms').doc(doc.id).update({
          views: (data.views || 0) + 1,
          lastViewed: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        // Display term details
        let safetyBadge = '';
        if (data.safety === 'office-safe') {
          safetyBadge = '<span class="safety-badge safety-office">Office Safe</span>';
        } else if (data.safety === 'casual') {
          safetyBadge = '<span class="safety-badge safety-casual">Casual / Friends</span>';
        } else if (data.safety === 'avoid') {
          safetyBadge = '<span class="safety-badge safety-avoid">Avoid in Professional</span>';
        }
        
        modalBody.innerHTML = `
          <div class="term-header">
            <h2 class="term-title">${data.term}</h2>
            <div class="term-pronunciation">
              ${data.pronunciation ? `/${data.pronunciation}/` : ''}
              ${safetyBadge}
            </div>
            <div class="term-meaning">${data.meaning}</div>
          </div>
          
          <div class="term-content">
            ${data.examples ? `
            <div class="term-section">
              <h4><i class="fas fa-quote-right"></i> Example Usage</h4>
              <div class="example-box">"${data.examples}"</div>
            </div>
            ` : ''}
            
            ${data.context ? `
            <div class="term-section">
              <h4><i class="fas fa-comment"></i> Context</h4>
              <p>${data.context}</p>
            </div>
            ` : ''}
            
            ${data.origin ? `
            <div class="term-section">
              <h4><i class="fas fa-history"></i> Origin</h4>
              <p>${data.origin}</p>
            </div>
            ` : ''}
            
            <div class="term-section">
              <h4><i class="fas fa-tags"></i> Details</h4>
              <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                <span style="background: rgba(99, 102, 241, 0.1); color: var(--primary); padding: 5px 12px; border-radius: 50px; font-size: 0.9rem;">
                  <i class="fas fa-folder"></i> ${data.category || 'General'}
                </span>
                <span style="background: rgba(245, 158, 11, 0.1); color: var(--secondary); padding: 5px 12px; border-radius: 50px; font-size: 0.9rem;">
                  <i class="fas fa-star"></i> ${data.rating || '⭐⭐⭐⭐⭐'}
                </span>
                <span style="background: rgba(16, 185, 129, 0.1); color: var(--accent); padding: 5px 12px; border-radius: 50px; font-size: 0.9rem;">
                  <i class="fas fa-calendar"></i> Added: ${data.createdAt ? new Date(data.createdAt.toDate()).toLocaleDateString() : 'Recently'}
                </span>
              </div>
            </div>
            
            <div class="term-stats">
              <div class="term-stat">
                <span class="term-stat-number">${data.views || 0}</span>
                <span class="term-stat-label">Views</span>
              </div>
              <div class="term-stat">
                <span class="term-stat-number">${data.popularity || 85}</span>
                <span class="term-stat-label">Popularity</span>
              </div>
              <div class="term-stat">
                <span class="term-stat-number">${data.rating ? data.rating.length : 5}</span>
                <span class="term-stat-label">Rating</span>
              </div>
            </div>
          </div>
        `;
        
        // Load related terms
        loadRelatedTerms(data.category, data.term);
      })
      .catch(error => {
        console.error('Error loading term:', error);
        modalBody.innerHTML = `
          <div class="term-header" style="background: var(--danger);">
            <h2 class="term-title">Error Loading Term</h2>
            <p>There was an error loading "${termName}". Please try again.</p>
          </div>
        `;
      });
  }
  
  function loadRelatedTerms(category, excludeTerm) {
    const relatedGrid = document.getElementById('relatedTermsGrid');
    const relatedSection = document.getElementById('relatedTermsSection');
    
    if (!category) {
      relatedSection.style.display = 'none';
      return;
    }
    
    firestoreDB.collection('slang_terms')
      .where('category', '==', category)
      .where('term', '!=', excludeTerm)
      .limit(4)
      .get()
      .then(snapshot => {
        if (snapshot.empty) {
          relatedSection.style.display = 'none';
          return;
        }
        
        relatedGrid.innerHTML = '';
        snapshot.forEach(doc => {
          const data = doc.data();
          const card = document.createElement('div');
          card.className = 'dictionary-card';
          card.style.minWidth = '200px';
          card.onclick = () => showTermDetails(data.term);
          card.innerHTML = `
            <div class="card-term">${data.term}</div>
            <div class="card-meaning">${data.meaning.substring(0, 60)}...</div>
          `;
          relatedGrid.appendChild(card);
        });
        
        relatedSection.style.display = 'block';
      })
      .catch(() => {
        relatedSection.style.display = 'none';
      });
  }
  
  function setupFilters() {
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        // Update active state
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        // Update filter
        currentFilter = this.getAttribute('data-filter');
        
        // Reload terms
        loadTerms();
      });
    });
    
    document.getElementById('sortSelect').addEventListener('change', function() {
      currentSort = this.value;
      loadTerms();
    });
  }
  
  function setupQuickSuggestions() {
    document.querySelectorAll('.quick-suggestion').forEach(suggestion => {
      suggestion.addEventListener('click', function() {
        const term = this.getAttribute('data-term');
        document.getElementById('dictionarySearch').value = term;
        performSearch(term);
      });
    });
  }
  
  function loadFeaturedTerms() {
    const carousel = document.getElementById('featuredCarousel');
    
    firestoreDB.collection('slang_terms')
      .where('featured', '==', true)
      .limit(8)
      .get()
      .then(snapshot => {
        if (snapshot.empty) {
          loadDefaultFeaturedTerms();
          return;
        }
        
        carousel.innerHTML = '';
        snapshot.forEach(doc => {
          const data = doc.data();
          const card = document.createElement('div');
          card.className = 'carousel-term';
          card.onclick = () => showTermDetails(data.term);
          card.innerHTML = `
            <div class="term">${data.term}</div>
            <div class="meaning">${data.meaning.substring(0, 60)}...</div>
            <div class="category">${data.category || 'General'}</div>
          `;
          carousel.appendChild(card);
        });
      })
      .catch(() => {
        loadDefaultFeaturedTerms();
      });
    
    function loadDefaultFeaturedTerms() {
      const defaultTerms = [
        {term: 'rizz', meaning: 'Charisma or romantic charm', category: 'Gen-Z'},
        {term: 'delulu', meaning: 'Delusional, especially romantically', category: 'Internet'},
        {term: 'chapri', meaning: 'Trying too hard to be cool', category: 'Indian'},
        {term: 'savage', meaning: 'Extremely cool or ruthless', category: 'Internet'},
        {term: 'ghoomna', meaning: 'To wander or roam around', category: 'Regional'},
        {term: 'jugaadu', meaning: 'Resourceful problem-solver', category: 'Indian'},
        {term: 'bindass', meaning: 'Carefree, without worries', category: 'Hindi/Urdu'},
        {term: 'timepass', meaning: 'Something done to pass time', category: 'Hinglish'}
      ];
      
      carousel.innerHTML = defaultTerms.map(term => `
        <div class="carousel-term" onclick="showTermDetails('${term.term}')">
          <div class="term">${term.term}</div>
          <div class="meaning">${term.meaning}</div>
          <div class="category">${term.category}</div>
        </div>
      `).join('');
    }
  }
  
  function loadMoreTerms() {
    if (isLoading || !lastVisible) return;
    
    isLoading = true;
    const loadMoreBtn = document.getElementById('loadMoreBtn');
    const originalText = loadMoreBtn.innerHTML;
    loadMoreBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
    loadMoreBtn.disabled = true;
    
    let query = firestoreDB.collection('slang_terms');
    
    if (currentFilter !== 'all') {
      query = query.where('category', '==', currentFilter);
    }
    
    switch(currentSort) {
      case 'alphabetical':
        query = query.orderBy('term', 'asc');
        break;
      case 'newest':
        query = query.orderBy('createdAt', 'desc');
        break;
      case 'trending':
        query = query.orderBy('views', 'desc');
        break;
      case 'popularity':
      default:
        query = query.orderBy('popularity', 'desc');
        break;
    }
    
    query.startAfter(lastVisible).limit(10).get()
      .then(snapshot => {
        const grid = document.getElementById('dictionaryGrid');
        
        if (snapshot.empty) {
          loadMoreBtn.style.display = 'none';
          return;
        }
        
        lastVisible = snapshot.docs[snapshot.docs.length - 1];
        
        snapshot.forEach(doc => {
          const data = doc.data();
          data.id = doc.id;
          allTerms.push(data);
          grid.appendChild(createTermCard(data));
        });
        
        // Update showing count
        const currentCount = parseInt(document.getElementById('showingCount').textContent);
        document.getElementById('showingCount').textContent = currentCount + snapshot.size;
        
        isLoading = false;
        loadMoreBtn.innerHTML = originalText;
        loadMoreBtn.disabled = false;
      })
      .catch(error => {
        console.error('Error loading more terms:', error);
        isLoading = false;
        loadMoreBtn.innerHTML = originalText;
        loadMoreBtn.disabled = false;
      });
  }
  
  function loadLocalTerms() {
    // Fallback to local data if Firestore fails
    const localTerms = [
      {
        term: 'rizz',
        meaning: 'Charisma or charm, especially in romantic contexts',
        category: 'Gen-Z',
        safety: 'office-safe',
        examples: 'He has so much rizz, everyone at the party wanted to talk to him.',
        views: 1250,
        rating: '⭐⭐⭐⭐⭐',
        popularity: 95
      },
      // Add more default terms as needed
    ];
    
    const grid = document.getElementById('dictionaryGrid');
    grid.innerHTML = '';
    
    localTerms.forEach(term => {
      grid.appendChild(createTermCard(term));
    });
    
    document.getElementById('showingCount').textContent = localTerms.length;
    document.getElementById('totalCount').textContent = '850+';
  }
  
  function logSearch(query, resultsCount) {
    if (!window.firestoreDB) return;
    
    firestoreDB.collection('search_logs').add({
      query: query,
      resultsCount: resultsCount,
      timestamp: firebase.firestore.FieldValue.serverTimestamp(),
      userAgent: navigator.userAgent.substring(0, 200)
    });
    
    // Update global search count
    firestoreDB.collection('stats').doc('global').update({
      totalSearches: firebase.firestore.FieldValue.increment(1),
      'lastSearches.' + new Date().toISOString().split('T')[0]: firebase.firestore.FieldValue.increment(1)
    });
  }
  
  function updateLiveStats() {
    if (!window.firestoreDB) return;
    
    firestoreDB.collection('stats').doc('global').get()
      .then(doc => {
        if (doc.exists) {
          const data = doc.data();
          document.getElementById('totalTermsLive').textContent = data.totalTerms + '+';
          document.getElementById('footerTermCount').textContent = data.totalTerms + '+';
          document.getElementById('footerUserCount').textContent = data.monthlyUsers + '+';
          document.getElementById('footerSearchCount').textContent = data.totalSearches + '+';
          
          // Update today's count
          const today = new Date().toISOString().split('T')[0];
          document.getElementById('updatedToday').textContent = data.lastAdded[today] || 0;
          document.getElementById('mostSearched').textContent = data.lastSearches[today] || '5,280';
        }
      })
      .catch(() => {
        // Use defaults
      });
  }
  
  function showRelatedTerms() {
    // Show some random related terms
    const relatedGrid = document.getElementById('relatedTermsGrid');
    const relatedSection = document.getElementById('relatedTermsSection');
    
    if (allTerms.length > 4) {
      // Pick 4 random terms
      const shuffled = [...allTerms].sort(() => 0.5 - Math.random());
      const selected = shuffled.slice(0, 4);
      
      relatedGrid.innerHTML = '';
      selected.forEach(term => {
        const card = document.createElement('div');
        card.className = 'dictionary-card';
        card.style.minWidth = '200px';
        card.onclick = () => showTermDetails(term.term);
        card.innerHTML = `
          <div class="card-term">${term.term}</div>
          <div class="card-meaning">${term.meaning.substring(0, 60)}...</div>
        `;
        relatedGrid.appendChild(card);
      });
      
      relatedSection.style.display = 'block';
    }
  }
  
  function setupAdTracking() {
    document.querySelectorAll('.ad-trackable').forEach(ad => {
      ad.addEventListener('click', function() {
        const adId = this.getAttribute('data-ad-id');
        
        // Track ad click
        if (window.firestoreDB) {
          firestoreDB.collection('ad_clicks').add({
            adId: adId,
            page: 'dictionary.html',
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
            userAgent: navigator.userAgent
          });
        }
        
        // Open ad page
        window.open('https://slangadda.ai/advertise.html', '_blank');
      });
    });
  }
  
  // Make functions available globally
  window.showTermDetails = showTermDetails;
  window.clearSearch = clearSearch;
</script>
</body>
</html>
